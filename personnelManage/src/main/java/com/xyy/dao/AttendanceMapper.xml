<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xyy.dao.AttendanceMapper">
    <insert id="addTodayAttendance">
        INSERT INTO T_ATTENDANCE("attend_no","e_id","date")
        select ATTEND_SEQ.nextval,A.* from(
        <foreach collection="employees" item="emp" index="index" separator="UNION ALL" >
            SELECT
            #{emp.e_id},to_char(sysdate,'yyyy-mm-dd')
            from dual
        </foreach>
        ) A
    </insert>
    <insert id="addTomorrowAttendance">
        INSERT INTO T_ATTENDANCE("attend_no","e_id","date")
        select ATTEND_SEQ.nextval,A.* from(
        <foreach collection="employees" item="emp" index="index" separator="UNION ALL" >
            SELECT
            #{emp.e_id},to_char((sysdate+1),'yyyy-mm-dd')
            from dual
        </foreach>
        ) A
    </insert>
    <select id="getTodayAttendance" resultType="com.xyy.model.Attendance">
        SELECT A.*,D."depart_no",D."depart_name",P."pos_no",P."pos_name",E."e_name"
         FROM T_DEPARTMENT D ,T_POSITION P ,T_EMPLOYEE E ,T_ATTENDANCE A
        WHERE D."depart_no"=P."depart_no" AND P."pos_no"=E."pos_no" AND E."e_id"=A."e_id"
        AND A."date"=to_char(sysdate,'yyyy-mm-dd')
    </select>
    <select id="getTomorrowAttendance" resultType="com.xyy.model.Attendance">
        SELECT * FROM T_ATTENDANCE WHERE "date"=to_char((sysdate+1),'yyyy-mm-dd')
    </select>
</mapper>